{% extends 'master.html' %}
{% block content %}



<!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->


<section>
    <div class="card">
        <div class="card-header">


            <div class="row">
                <div class="col-md-4">
                    <h4>Team Master</h4>
                </div>
                <div class="col-md-4"></div>
                <div class="col-md-4 text-right">
                    <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" data-target="#exampleModal3"
                        style="color:white">+ Add New</a>

                </div>

            </div>
            <div class="card-body">


                <table id="example" class="display" style="width:100%">

                    <thead>
                        <tr>
                            <th style="text-align:center">SL No.</th>
                            <th style="text-align:center">Team</th>
                            <th style="text-align:center">Financial Strategy</th>
                            <th style="text-align:center">Marketing Strategy</th>
                            <th style="text-align:center">Company 1</th>
                            <th style="text-align:center">Company 2</th>
                            <th style="text-align:center">Company 3</th>
                            <th style="text-align:center">Customer</th>
                            <th style="text-align:center">Management</th>
                            <th style="text-align:center">F-ACW</th>
                            <th style="text-align:center">Action</th>


                        </tr>
                    </thead>
                    <tbody style="text-align: center;">
                        {% for x in mydata %}
                        <tr>
                            <td style="text-align:center">{{ forloop.counter }}</td>
                            <td style="text-align:center">{{ x.team }}</td>
                            <td style="text-align:center">{{ x.f_strategy }}</td>
                            <td style="text-align:center">{{ x.m_strategy }}</td>
                            <td style="text-align:center">{{ x.comp1 }}</td>
                            <td style="text-align:center">{{ x.comp2 }}</td>
                            <td style="text-align:center">{{ x.comp3 }}</td>
                            <td style="text-align:center">0 / {{ customer_cmf }}</td>
                            <td style="text-align:center">0 / {{ management_cmf }}</td>
                            <td style="text-align:center">0 / {{ facw_cmf }}</td>
                            <td style="text-align:center">


                                <form action="/teammaster_delete/{{ x.id }}" method="POST">
                                    {% csrf_token %}
                                    <a href="#" class="btn btn-info btn-sm"  role="button" data-toggle="modal" data-target="#showmodal{{ x.id }}" style="color:white" onclick="func11(this.id)"> <i class="fa fa-eye" style="color:white;"></i></a>
                                    <a href="/teammaster_edit/{{ x.id }}" class="btn btn-primary btn-sm"  role="button" data-toggle="modal" data-target="#editmodal{{ x.id }}" style="color:white" onclick="func1(this.id)"> <i class="fa fa-edit" style="color:white;"></i></a>
                                    <button type="submit" class="btn btn-danger  btn-sm show_confirm" data-toggle="tooltip" title='Delete'> <i class="fa fa-trash" style="color:white;"></i></button>
                                </form>
                            </td>

                        </tr>

                        <div class="modal fade" id="showmodal{{ x.id }}" tabindex="-1" role="dialog" aria-labelledby="showmodalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-slideout modal-md" role="document" style="margin-right:-6px; margin-top:0px">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h4 class="modal-title" id="showmodalLabel">Show Team Master
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">×</span>
                                  </button>
                                  </h4>
                                </div>
                                <div class="modal-body">
                                    <div class="card-body">
                                        {% csrf_token %}
                                        <div class="row">
                                        <div class="col-md-6">
                                        <div class='form-group'>
                                            <label>Team</label>
                                            <input type="text" name="name" value="{{ x.team }}" class="form-control" readonly style="background-color: transparent;">
                                        </div>
                                        <br>
                                        <div class='form-group'>
                                            <label>Financial Strategy<span style="color:red">*</span></label>
                                            <input type="text" name="f_strategy" value="{{ x.f_strategy }}" class="form-control" readonly style="background-color: transparent;">
                                        </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class='form-group'>
                                                <label>Marketing Strategy<span style="color:red">*</span></label>
                                                <input type="text" name="m_strategy" value="{{ x.m_strategy }}" class="form-control" readonly style="background-color: transparent;">
                                            </div> 
                                        </div>
                                        </div>
                                      </div>
                                      </div>
                                </div>
                              </div>
                            </div>
                            <div>

                                <div class="modal fade" id="editmodal{{ x.id }}" tabindex="-1" role="dialog" aria-labelledby="showmodalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-slideout modal-md" role="document" style="margin-right:-6px; margin-top:0px">
                                      <div class="modal-content">
                                        <div class="modal-header">
                                          <h4 class="modal-title" id="showmodalLabel">Edit Team Master
                                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">×</span>
                                          </button>
                                          </h4>
                                        </div>
                                        <div class="modal-body">
                                            <form method = "POST" action="/teammaster_edit/{{ x.id }}">
                                            <div class="card-body">
                                                {% csrf_token %}
                                                <div class="row">
                                                <div class="col-md-6">
                                                <div class='form-group'>
                                                    <label>Team <span style="color:red">*</span></label>
                                                    <input type="text" name="team" value="{{ x.team }}" class="form-control">
                                                </div>
                                                  <br>
                                                <div class='form-group'>
                                                    <label>Financial Strategy<span style="color:red">*</span></label>
                                                    <select name="f_strategy" class="form-control select2" style="width: 100%;" required>
                                                        <option  value="{{ x.f_strategy }}" selected>{{ x.f_strategy }}</option>
                                                        {% for ff in f_strategy %}
                                                        <option value="{{ff.strategy}}">{{ff.strategy}}</option>
                                                        {% endfor %}
                                                      </select>
                                                </div>
                                                <br>
                                                <div class='form-group'>
                                                    <label>Company 2<span style="color:red">*</span></label>
                                                    <select name="comp2" class="form-control select2" style="width: 100%;" id="c22" onchange="myf22(this.value)" required>
                                                        <option value="{{ x.comp2 }}" selected>{{x.comp2}}</option>
                                                    </select>
                                                </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class='form-group'>
                                                        <label>Marketing Strategy<span style="color:red">*</span></label>
                                                        <select name="m_strategy" class="form-control select2" style="width: 100%;" required>
                                                            <option value="{{ x.m_strategy }}" selected>{{ x.m_strategy }}</option>
                                                            {% for mm in m_strategy %}
                                                            <option value="{{mm.type}}">{{mm.type}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>    
                                                    <br>
                                                    <div class='form-group'>
                                                        <label>Company 1<span style="color:red">*</span></label>
                                                        <select name="comp1" class="form-control select2" style="width: 100%;" id="c11" onchange="myf11(this.value)" required>
                                                            <option value="{{ x.comp1 }}" selected>{{x.comp1}}</option>
                                                            {% for cc in company %}
                                                            <option value="{{cc.payroll}}">{{cc.payroll}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <br>
                                                    <div class='form-group'>
                                                        <label>Company 3<span style="color:red">*</span></label>
                                                        <select name="comp3" class="form-control select2" style="width: 100%;" id="c33" required>
                                                            <option value="{{ x.comp3 }}" selected>{{ x.comp3 }}</option>
                                                        </select>
                                                    </div>                                           
                                                </div>
                                                </div>

                                                <div class="col-xs-12 col-sm-12 col-md-12 text-center">
                                                    <br>
                                                    <button type="submit" class="btn btn-primary btn-sm">Submit</button>
                                                </div>
                                                </div>
                                            </form>
                                              </div>
                                              </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div>
                        {% endfor %}
                </table>

                <div class="modal fade" id="exampleModal3" tabindex="-1" role="dialog"
                    aria-labelledby="exampleModalLabel3" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-slideout modal-md" role="document" style="margin-right:-6px; margin-top:0px">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title" id="exampleModalLabel">Add Team Master
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </h4>
                            </div>
                            <div class="modal-body">

                                <div class="card-body">
                                    <form method="POST">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class='form-group'>
                                                    <label class="floating-label">Team<span style="color:red">*</span></label><br>
                                                    <input type="text" name="team"
                                                        class="form-control inputText" required>
                                                </div>
                                                    <br>
                                                <div class='form-group'>
                                                    <label>Financial Strategy<span style="color:red">*</span></label>
                                                    <select name="f_strategy" class="form-control select2" style="width: 100%;" required>
                                                        <option value="" selected disabled>---Select Please---</option>
                                                        {% for ff in f_strategy %}
                                                        <option value="{{ff.strategy}}">{{ff.strategy}}</option>
                                                        {% endfor %}
                                                      </select>
                                                </div>
                                                <br>
                                                <div class='form-group'>
                                                    <label>Company 2<span style="color:red">*</span></label>
                                                    <select name="comp2" class="form-control select2" style="width: 100%;" id="c2" onchange="myf2(this.value)" required>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class='form-group'>
                                                    <label>Marketing Strategy<span style="color:red">*</span></label>
                                                    <select name="m_strategy" style="width: 100%;" class="form-control select2" required>
                                                        <option value="" selected disabled>---Select Please---</option>
                                                        {% for mm in m_strategy %}
                                                        <option value="{{mm.type}}">{{mm.type}}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <br>
                                                <div class='form-group'>
                                                    <label>Company 1<span style="color:red">*</span></label>
                                                    <select name="comp1" class="form-control select2" style="width: 100%;" id="c1" onchange="myf1(this.value)" required>
                                                        <option value="---Select Please---" selected disabled>---Select Please---</option>
                                                        {% for cc in company %}
                                                        <option value="{{cc.payroll}}">{{cc.payroll}}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <br>
                                                <div class='form-group'>
                                                    <label>Company 3<span style="color:red">*</span></label>
                                                    <select name="comp3" style="width: 100%;" class="form-control select2" id="c3" required>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-xs-12 col-sm-12 col-md-12 text-center">
                                            <br>
                                            <button type="submit" class="btn btn-primary btn-sm">Submit</button>
                                        </div>
                                </div>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            </div>





        </div>
    </div>

    {% for message in messages %}

    {% if 'success' == message.tags %}
    <script type="text/javascript">
        // Default Configuration
        $(document).ready(function () {
            toastr.options = {
                'closeButton': true,
                'debug': false,
                'newestOnTop': false,
                'progressBar': true,
                'positionClass': 'toast-top-right',
                'preventDuplicates': false,
                'showDuration': '1000',
                'hideDuration': '1000',
                'timeOut': '3000',
                'extendedTimeOut': '1000',
                'showEasing': 'swing',
                'hideEasing': 'linear',
                'showMethod': 'fadeIn',
                'hideMethod': 'fadeOut',
            }
        });

        // Toast Type

        toastr.success('Data Submitted Successfully');

        // Toast Image and Progress Bar
        $('#image').click(function (event) {
            toastr.options.progressBar = true,
                toastr.info('<img src="https://image.flaticon.com/icons/svg/34/34579.svg" style="width:150px;">', 'Toast Image')
        });


        // Toast Position
        $('#position').click(function (event) {
            var pos = $('input[name=position]:checked', '#positionForm').val();
            toastr.options.positionClass = "toast-" + pos;
            toastr.options.preventDuplicates = false;
            toastr.info('This sample position', 'Toast Position')
        });
    </script>

    {% elif 'error' == message.tags %}
    <script type="text/javascript">
        // Default Configuration
        $(document).ready(function () {
            toastr.options = {
                'closeButton': true,
                'debug': false,
                'newestOnTop': false,
                'progressBar': false,
                'positionClass': 'toast-top-right',
                'preventDuplicates': false,
                'showDuration': '1000',
                'hideDuration': '1000',
                'timeOut': '5000',
                'extendedTimeOut': '1000',
                'showEasing': 'swing',
                'hideEasing': 'linear',
                'showMethod': 'fadeIn',
                'hideMethod': 'fadeOut',
            }
        });

        // Toast Type

        toastr.error('Data Deleted Successfully');

        // Toast Image and Progress Bar
        $('#image').click(function (event) {
            toastr.options.progressBar = true,
                toastr.info('<img src="https://image.flaticon.com/icons/svg/34/34579.svg" style="width:150px;">', 'Toast Image')
        });


        // Toast Position
        $('#position').click(function (event) {
            var pos = $('input[name=position]:checked', '#positionForm').val();
            toastr.options.positionClass = "toast-" + pos;
            toastr.options.preventDuplicates = false;
            toastr.info('This sample position', 'Toast Position')
        });
    </script>

    {% elif 'info' == message.tags %}

    <script type="text/javascript">
        // Default Configuration
        $(document).ready(function () {
            toastr.options = {
                'closeButton': true,
                'debug': false,
                'newestOnTop': false,
                'progressBar': false,
                'positionClass': 'toast-top-right',
                'preventDuplicates': false,
                'showDuration': '1000',
                'hideDuration': '1000',
                'timeOut': '5000',
                'extendedTimeOut': '1000',
                'showEasing': 'swing',
                'hideEasing': 'linear',
                'showMethod': 'fadeIn',
                'hideMethod': 'fadeOut',
            }
        });

        // Toast Type

        toastr.info('Data Updated Successfully');

        // Toast Image and Progress Bar
        $('#image').click(function (event) {
            toastr.options.progressBar = true,
                toastr.info('<img src="https://image.flaticon.com/icons/svg/34/34579.svg" style="width:150px;">', 'Toast Image')
        });


        // Toast Position
        $('#position').click(function (event) {
            var pos = $('input[name=position]:checked', '#positionForm').val();
            toastr.options.positionClass = "toast-" + pos;
            toastr.options.preventDuplicates = false;
            toastr.info('This sample position', 'Toast Position')
        });
    </script>
    {% endif %}

    {% endfor %}

</section>


<!-- <script>
    $("select").select2({
      tags: "true",
      dropdownParent: $('#exampleModal3'),
    });
  </script> -->



<!-- <script>
    function myf1(id)
    {

      var c1 = document.getElementById("c1").value;

      console.log(c1);

      $('#overlay').fadeIn(300);
      $.ajax({
         url: '/team_company/'+id,
         type: 'get',
         dataType: 'json',
         success: function(response)
         {
        //   document.getElementById("c2").value=response[0];
  
         },
       }).done(function() {
        setTimeout(function(){
          $("#overlay").fadeOut(300);
        },500);
      });
    }
</script> -->

<!--create ajax start-->
<script>
    function myf1(id)
    {
      var $c1 = document.getElementById("c1").value;
      var $c2=$('#c2'); 

      console.log($c1);
  
      $('#overlay').fadeIn(300);
      $.ajax({
         url: '/team_company/'+id,
         type: 'get',
         dataType: 'json',
         success: function(response)
         {
            // console.log(document.getElementById("c2").value);

            // console.log(response['company']);
            $c2.empty();
            $c2.append($("<option>---Select Please---</option>").attr("value", ''));
            $.each(response['company'], function(value, key)
            {
            $c2.append($("<option></option>").attr("value", key['payroll']).text(key['payroll']));
            });

            $c2.select2(); 
            // $('#c2').select2();
          },
       }).done(function() {
        setTimeout(function(){
          $("#overlay").fadeOut(300);
        },500);
      });
    }
</script>


<script>
    function myf2(id)
    {
      var $c1 = document.getElementById("c1").value;
      var $c2 = document.getElementById("c2").value;
      var $c3=$('#c3');  

      console.log($c1, $c2);
  
      $('#overlay').fadeIn(300);
      $.ajax({
         url: '/team_company2/'+id+'/'+$c1,
         type: 'get',
         dataType: 'json',
         success: function(response)
         {
            // console.log(document.getElementById("c2").value);

            // console.log(response['company']);
            $c3.empty();
            $c3.append($("<option>---Select Please---</option>").attr("value", ''));
            $.each(response['company'], function(value, key)
            {
            $c3.append($("<option></option>").attr("value", key['payroll']).text(key['payroll']));
            });

            $c3.select2(); 

          },
       }).done(function() {
        setTimeout(function(){
          $("#overlay").fadeOut(300);
        },500);
      });
    }
</script>
<!--create ajax end-->

<!--edit ajax start-->
<script>
    function myf11(id)
    {
      var $c11 = document.getElementById("c11").value;
      var $c22 = $('#c22');  ; 

      console.log($c11);
  
      $('#overlay').fadeIn(300);
      $.ajax({
         url: '/team_company11/'+id,
         type: 'get',
         dataType: 'json',
         success: function(response)
         {
           
            $.each(response['company'], function(value, key)
            {
            $c22.append($("<option></option>").attr("value", key['payroll']).text(key['payroll']));
            });

            $c22.select2(); 
          },
       }).done(function() {
        setTimeout(function(){
          $("#overlay").fadeOut(300);
        },500);
      });
    }
</script>


<script>
    function myf22(id)
    {
      var $c11 = document.getElementById("c11").value;
      var $c22 = document.getElementById("c22").value;
      var $c33=$('#c33');  

      console.log($c11, $c22);
  
      $('#overlay').fadeIn(300);
      $.ajax({
         url: '/team_company22/'+id+'/'+$c11,
         type: 'get',
         dataType: 'json',
         success: function(response)
         {

            $.each(response['company'], function(value, key)
            {
            $c33.append($("<option></option>").attr("value", key['payroll']).text(key['payroll']));
            });

            $c33.select2(); 

          },
       }).done(function() {
        setTimeout(function(){
          $("#overlay").fadeOut(300);
        },500);
      });
    }
</script>
<!--edit ajax end-->


<script>
    $('.select2').select2();
</script>
{% endblock %}